//
// ExaHyPE2 solver file
// Generated by Peano's Python API
// www.peano-framework.org
//
// This is generated. If you change fundamental properties, you will have to
// generate this file. Backup your manual changes before you do so.
//
#ifndef _{INCLUDE_GUARD}_
#define _{INCLUDE_GUARD}_


#include "exahype2/RefinementControl.h"

#include "tarch/la/Vector.h"

#include "peano4/utils/Globals.h"




{OPEN_NAMESPACE}
  class {CLASSNAME};
{CLOSE_NAMESPACE}



class {FULL_QUALIFIED_CLASSNAME} {{
  protected:
    double _timeStamp;

    /**
     * Determine whether a kernel shall be called
     */
    bool _projectOntoFace;
    bool _solveCell;
  public:
    {CLASSNAME}();

    double getMinTimeStamp() const;
    double getMaxTimeStamp() const;
    double getMinTimeStepSize() const;
    double getMaxTimeStepSize() const;

    bool startNewTimeStepOnCellAndProjectOntoFace() const;
    bool solveCellProblemAndFinishTimeStepOnCell() const;

    /**
     * @param Q Vector of unknowns
     * @param t Time
     */
    ::exahype2::RefinementCommand refinementCriterion(
      double* Q,
      const tarch::la::Vector<Dimensions,double>&  cellCentre,
      const tarch::la::Vector<Dimensions,double>&  cellH,
      double                                       t
    );

    void adjustSolution(
      double* Q,
      const tarch::la::Vector<Dimensions,double>&  cellCentre,
      const tarch::la::Vector<Dimensions,double>&  cellH,
      double                                       t
    );

    void boundaryConditions(
      double* Q,
      const tarch::la::Vector<Dimensions,double>&  faceCentre,
      const tarch::la::Vector<Dimensions,double>&  faceH,
      double                                       t,
	  const tarch::la::Vector<Dimensions,double>&  normal
    );

    /**
     * Solve cell, i.e. two triangles
     *
     * @param QCell These are all unknowns of the complete cell.
     */
    void solveCell(
      double* QCell,
      double* QLeftFace,
      double* QBottomFace,
      double* QRightFace,
      double* QUpperFace,
      const tarch::la::Vector<Dimensions,double>&  cellCentre,
      const tarch::la::Vector<Dimensions,double>&  cellH,
      double                                       t
    );

    void projectOntoFaces(
      double* QCell,
      double* QLeftFace,
      double* QBottomFace,
      double* QRightFace,
      double* QUpperFace,
      const tarch::la::Vector<Dimensions,double>&  cellCentre,
      const tarch::la::Vector<Dimensions,double>&  cellH,
      double                                       t
    );

    /**
     * If you hook into this routine, ensure the abstract base class
     * operation is still invoked.
     */
    virtual void startTimeStep(
      double globalMinTimeStamp,
      double globalMaxTimeStamp,
      double globalMinTimeStepSize,
      double globalMaxTimeStepSize
    );

    /**
     * If you hook into this routine, ensure the abstract base class
     * operation is still invoked.
     */
    virtual void finishTimeStep();
}};


#endif
